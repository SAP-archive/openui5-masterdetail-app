/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./library","sap/ui/Device","sap/ui/core/Control","sap/ui/core/library","sap/m/ToggleButton","sap/m/Button","./DynamicPageHeaderRenderer","sap/ui/core/InvisibleMessage"],function(t,e,n,o,i,s,a,u){"use strict";var r=o.InvisibleMessageMode;var p=n.extend("sap.f.DynamicPageHeader",{metadata:{library:"sap.f",properties:{pinnable:{type:"boolean",group:"Appearance",defaultValue:true},backgroundDesign:{type:"sap.m.BackgroundDesign",group:"Appearance"}},defaultAggregation:"content",aggregations:{content:{type:"sap.ui.core.Control",multiple:true},_pinButton:{type:"sap.m.Button",multiple:false,visibility:"hidden"},_collapseButton:{type:"sap.m.Button",multiple:false,visibility:"hidden"}},designtime:"sap/f/designtime/DynamicPageHeader.designtime"}});p._getResourceBundle=function(){return sap.ui.getCore().getLibraryResourceBundle("sap.f")};p.ARIA={ARIA_CONTROLS:"aria-controls",ARIA_EXPANDED:"aria-expanded",ARIA_LABEL:"aria-label",LABEL_EXPANDED:p._getResourceBundle().getText("EXPANDED_HEADER"),LABEL_COLLAPSED:p._getResourceBundle().getText("SNAPPED_HEADER"),LABEL_PINNED:p._getResourceBundle().getText("PIN_HEADER"),LABEL_UNPINNED:p._getResourceBundle().getText("UNPIN_HEADER"),TOOLTIP_COLLAPSE_BUTTON:p._getResourceBundle().getText("COLLAPSE_HEADER_BUTTON_TOOLTIP"),STATE_TRUE:"true",STATE_FALSE:"false"};p.prototype.init=function(){this._bShowCollapseButton=true;this._oInvisibleMessage=null};p.prototype.onAfterRendering=function(){this._initARIAState();this._initPinButtonARIAState();if(!this._oInvisibleMessage){this._oInvisibleMessage=u.getInstance()}};p.prototype._togglePinButton=function(t){this._getPinButton().setPressed(t)};p.prototype._setShowPinBtn=function(t){this._getPinButton().$().toggleClass("sapUiHidden",!t)};p.prototype._pinUnpinFireEvent=function(){this.fireEvent("_pinUnpinPress")};p.prototype._onCollapseButtonPress=function(){this.fireEvent("_headerVisualIndicatorPress")};p.prototype._onCollapseButtonMouseOver=function(){this.fireEvent("_visualIndicatorMouseOver")};p.prototype._onCollapseButtonMouseOut=function(){this.fireEvent("_visualIndicatorMouseOut")};p.prototype._initARIAState=function(){var t=this.$();t.attr(p.ARIA.ARIA_EXPANDED,p.ARIA.STATE_TRUE);t.attr(p.ARIA.ARIA_LABEL,p.ARIA.LABEL_EXPANDED)};p.prototype._initPinButtonARIAState=function(){var t;if(this.getPinnable()){t=this._getPinButtonJQueryRef();t.attr(p.ARIA.ARIA_CONTROLS,this.getId())}};p.prototype._updateARIAState=function(t){var e=this.$();if(t){e.attr(p.ARIA.ARIA_EXPANDED,p.ARIA.STATE_TRUE);e.attr(p.ARIA.ARIA_LABEL,p.ARIA.LABEL_EXPANDED)}else{e.attr(p.ARIA.ARIA_EXPANDED,p.ARIA.STATE_FALSE);e.attr(p.ARIA.ARIA_LABEL,p.ARIA.LABEL_COLLAPSED)}};p.prototype._updateARIAPinButtonState=function(t){var e=this._getPinButton();if(t){e.setTooltip(p.ARIA.LABEL_UNPINNED)}else{e.setTooltip(p.ARIA.LABEL_PINNED)}};p.prototype._getPinButton=function(){if(!this.getAggregation("_pinButton")){var t=new i({id:this.getId()+"-pinBtn",icon:"sap-icon://pushpin-off",tooltip:p.ARIA.LABEL_PINNED,press:this._pinUnpinFireEvent.bind(this)}).addStyleClass("sapFDynamicPageHeaderPinButton");this.setAggregation("_pinButton",t,true)}return this.getAggregation("_pinButton")};p.prototype._getCollapseButton=function(){if(!this.getAggregation("_collapseButton")){var t=new s({id:this.getId()+"-collapseBtn",icon:"sap-icon://slim-arrow-up",press:this._onCollapseButtonPress.bind(this),tooltip:p.ARIA.TOOLTIP_COLLAPSE_BUTTON}).addStyleClass("sapFDynamicPageToggleHeaderIndicator");t.onmouseover=this._onCollapseButtonMouseOver.bind(this);t.onmouseout=this._onCollapseButtonMouseOut.bind(this);this.setAggregation("_collapseButton",t,true)}return this.getAggregation("_collapseButton")};p.prototype._toggleCollapseButton=function(t){this._setShowCollapseButton(t);this._getCollapseButton().$().toggleClass("sapUiHidden",!t)};p.prototype._getShowCollapseButton=function(){return this._bShowCollapseButton&&!!this.getContent().length};p.prototype._setShowCollapseButton=function(t){this._bShowCollapseButton=!!t};p.prototype._focusCollapseButton=function(){this._getCollapseButton().$().trigger("focus");this._oInvisibleMessage.announce(this._getCollapseButton().getTooltip(),r.Polite)};p.prototype._focusPinButton=function(){this._getPinButtonJQueryRef().trigger("focus")};p.prototype._getPinButtonJQueryRef=function(){return this._getPinButton().$()};p.prototype._getState=function(){var t=this.getContent(),n=t.length>0,o=this.getPinnable()&&n&&!e.system.phone,i=this._getPinButton(),s=this._getCollapseButton();s.toggleStyleClass("sapUiHidden",!this._getShowCollapseButton());return{content:t,headerHasContent:n,headerPinnable:o,hasContent:t.length>0,pinButton:i,collapseButton:s}};return p});