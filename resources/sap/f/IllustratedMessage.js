/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./library","sap/m/Text","sap/m/Title","sap/m/FormattedText","sap/f/Illustration","sap/ui/core/Control","sap/ui/core/Core","sap/ui/core/library","sap/ui/core/ResizeHandler","sap/ui/thirdparty/jquery","./IllustratedMessageRenderer"],function(t,e,i,s,r,a,n,l,o,p,u){"use strict";var d=t.IllustratedMessageSize;var g=t.IllustratedMessageType;var h=l.TextAlign;var _=a.extend("sap.f.IllustratedMessage",{metadata:{library:"sap.f",properties:{description:{type:"string",group:"Misc",defaultValue:""},enableFormattedText:{type:"boolean",group:"Appearance",defaultValue:false},illustrationSize:{type:"sap.f.IllustratedMessageSize",group:"Appearance",defaultValue:d.Auto},illustrationType:{type:"string",group:"Appearance",defaultValue:g.NoSearchResults},title:{type:"string",group:"Misc",defaultValue:""}},aggregations:{additionalContent:{type:"sap.m.Button",multiple:true},_formattedText:{type:"sap.m.FormattedText",multiple:false,visibility:"hidden"},_illustration:{type:"sap.f.Illustration",visibility:"hidden",multiple:false},_text:{type:"sap.m.Text",multiple:false,visibility:"hidden"},_title:{type:"sap.m.Title",multiple:false,visibility:"hidden"}},dnd:{draggable:false,droppable:true}}});_.PREPENDS={DESCRIPTION:"IllustratedMessage_DESCRIPTION_",TITLE:"IllustratedMessage_TITLE_"};_.BREAK_POINTS={DIALOG:679,SPOT:319,BASE:259};_.MEDIA={BASE:"sapFIllustratedMessage-Base",SPOT:"sapFIllustratedMessage-Spot",DIALOG:"sapFIllustratedMessage-Dialog",SCENE:"sapFIllustratedMessage-Scene"};_.RESIZE_HANDLER_ID={CONTENT:"_sContentResizeHandlerId"};_.prototype.init=function(){this._updateInternalIllustrationSetAndType(this.getIllustrationType())};_.prototype.onBeforeRendering=function(){this._detachResizeHandlers()};_.prototype.onAfterRendering=function(){this._updateDomSize();this._attachResizeHandlers();this._preventWidowWords(this._getTitle().getDomRef());this._preventWidowWords(this._getDescription().getDomRef())};_.prototype.exit=function(){this._detachResizeHandlers()};_.prototype.setIllustrationType=function(t){if(this.getIllustrationType()===t){return this}this._updateInternalIllustrationSetAndType(t);return this.setProperty("illustrationType",t)};_.prototype._getDefaultDescription=function(){return this._getResourceBundle().getText(_.PREPENDS.DESCRIPTION+this._sIllustrationType,null,true)};_.prototype._getDescription=function(){return this.getEnableFormattedText()?this._getFormattedText():this._getText()};_.prototype._getFormattedText=function(){var t=this.getDescription(),e=this.getAggregation("_formattedText");if(!e){e=new s({textAlign:h.Center});this.setAggregation("_formattedText",e)}if(t){e.setHtmlText(t)}else{e.setHtmlText(this._getDefaultDescription())}return e};_.prototype._getIllustration=function(){var t=this.getAggregation("_illustration");if(!t){t=new r;this.setAggregation("_illustration",t)}return t};_.prototype._getResourceBundle=function(){return n.getLibraryResourceBundle("sap.f")};_.prototype._getText=function(){var t=this.getDescription(),i=this.getAggregation("_text");if(!i){i=new e({textAlign:h.Center});this.setAggregation("_text",i)}if(t){i.setText(t)}else{i.setText(this._getDefaultDescription())}return i};_.prototype._getTitle=function(){var t=this.getTitle(),e=this.getAggregation("_title");if(!e){e=new i({wrapping:true});this.setAggregation("_title",e)}if(t){e.setText(t)}else{e.setText(this._getResourceBundle().getText(_.PREPENDS.TITLE+this._sIllustrationType,null,true))}return e};_.prototype._preventWidowWords=function(t){var e,i,s=window.HTMLElement;if(!(s&&t instanceof s)){return}e=p(t);i=e.html();i=i.replace(/ ([^ ]*)$/,"&nbsp;$1");e.html(i)};_.prototype._updateDomSize=function(){var t=this.getDomRef(),e;if(t){e=this.getIllustrationSize();if(e===d.Auto){this._updateMedia(t.getBoundingClientRect().width)}else{this._updateMediaStyle(_.MEDIA[e.toUpperCase()])}}};_.prototype._updateInternalIllustrationSetAndType=function(t){var e=t.split("-");this._sIllustrationSet=e[0];this._sIllustrationType=e[1]};_.prototype._onResize=function(t){var e=t.size.width;this._updateMedia(e)};_.prototype._updateMedia=function(t){if(!t){return}if(t<=_.BREAK_POINTS.BASE){this._updateMediaStyle(_.MEDIA.BASE)}else if(t<=_.BREAK_POINTS.SPOT){this._updateMediaStyle(_.MEDIA.SPOT)}else if(t<=_.BREAK_POINTS.DIALOG){this._updateMediaStyle(_.MEDIA.DIALOG)}else{this._updateMediaStyle(_.MEDIA.SCENE)}};_.prototype._updateMediaStyle=function(t){Object.keys(_.MEDIA).forEach(function(e){var i=t===_.MEDIA[e],s=e.charAt(0)+e.slice(1).toLowerCase();this.toggleStyleClass(_.MEDIA[e],i);if(i&&t!==_.MEDIA.BASE){this._getIllustration().setSet(this._sIllustrationSet,true).setMedia(s,true).setType(this._sIllustrationType)}},this)};_.prototype._attachResizeHandlers=function(){var t=this.getIllustrationSize();if(this.getDomRef()&&t===d.Auto){this._registerResizeHandler(_.RESIZE_HANDLER_ID.CONTENT,this,this._onResize.bind(this))}};_.prototype._detachResizeHandlers=function(){this._deRegisterResizeHandler(_.RESIZE_HANDLER_ID.CONTENT)};_.prototype._registerResizeHandler=function(t,e,i){if(!this[t]){this[t]=o.register(e,i)}};_.prototype._deRegisterResizeHandler=function(t){if(this[t]){o.deregister(this[t]);this[t]=null}};return _});